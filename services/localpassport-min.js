const passport=require("passport"),JwtStrategy=require("passport-jwt").Strategy,ExtractJwt=require("passport-jwt").ExtractJwt,LocalStrategy=require("passport-local").Strategy,config=require("../config/dev"),keys=require("../config/keys"),User=require("../models/User"),localOptions={usernameField:"email"},localLogin=new LocalStrategy(localOptions,function(t,e,r){User.findOne({"local.email":t},function(t,o){return t?r(t):o?void o.comparePassword(e,function(t,e){return t?r(t):e?r(null,o):r(null,!1)}):r(null,!1)})}),jwtOptions={jwtFromRequest:ExtractJwt.fromHeader("auth"),secretOrKey:config.secret},jwtLogin=new JwtStrategy(jwtOptions,function(t,e){User.findById(t.sub,function(t,r){if(t)return e(t,!1);r?e(null,r):e(null,!1)})});passport.use(jwtLogin),passport.use(localLogin);