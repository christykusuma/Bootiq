function tokenForUser(e){const o=(new Date).getTime();return jwt.encode({sub:e.id},config.secret)}const User=require("../models/User"),jwt=require("jwt-simple"),config=require("../config/dev");exports.signin=function(e,o,n){o.send({token:tokenForUser(e.user)})},exports.signup=function(e,o,n){const r=e.body.fname,s=e.body.lname,t=e.body.email,i=e.body.password,d=e.body.dob,u=e.body.city,c=e.body.country;if(!t||!i)return o.status(422).send({error:"You must provide email and password"});User.findOne({"local.email":t},function(e,r){return e?n(e):r?o.status(422).send({error:"Email is in use"}):void 0});const a=new User({method:"local",local:{fname:r,lname:s,email:t,password:i,dob:d,city:u,country:c}});a.save(function(e){if(e)return n(e);o.json({token:tokenForUser(a)})})};