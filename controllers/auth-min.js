function tokenForUser(e){const n=(new Date).getTime();return jwt.encode({sub:e.id,name:e.name,admin:e.admin},config.secret)}const User=require("../models/User"),jwt=require("jwt-simple"),config=require("../config/dev");exports.signin=function(e,n,o){console.log("User token is",tokenForUser(e.user)),n.send({token:tokenForUser(e.user)})},exports.signup=function(e,n,o){const r=e.body.fname,s=e.body.lname,t=e.body.email,i=e.body.password,a=e.body.city,d=e.body.country,u=!1;if(!t||!i)return n.status(422).send({error:"You must provide email and password"});User.findOne({"local.email":t},function(e,r){return e?o(e):r?n.status(422).send({error:"Email is in use"}):void 0});const c=new User({method:"local",local:{fname:r,lname:s,email:t,password:i,city:a,country:d,admin:!1}});c.save(function(e){if(e)return o(e);n.json({token:tokenForUser(c)})})};